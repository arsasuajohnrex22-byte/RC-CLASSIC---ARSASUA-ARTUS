<!DOCTYPE html>
<html>
<head>
    <title>Database Connection Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .test { margin: 20px 0; padding: 15px; border-radius: 8px; }
        .success { background: #d4ffd4; border: 2px solid #28a428; }
        .error { background: #ffd4d4; border: 2px solid #a42828; }
        .loading { background: #fff3cd; border: 2px solid #ffc107; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 4px; overflow-x: auto; }
        button { padding: 10px 20px; background: #d4af37; color: black; border: none; cursor: pointer; }
        button:hover { background: #b8941f; }
    </style>
</head>
<body>
    <h1>üèçÔ∏è Database Connection Test</h1>
    
    <div id="status">Testing connections...</div>
    
    <div id="tests"></div>
    
    <button onclick="runTests()">Run Tests Again</button>
    
    <script>
        async function testAPI(endpoint, name) {
            const testDiv = document.createElement('div');
            testDiv.className = 'test loading';
            testDiv.innerHTML = `<h3>${name}...</h3>`;
            document.getElementById('tests').appendChild(testDiv);
            
            try {
                const startTime = Date.now();
                const response = await fetch(`http://localhost/vintage-moto/api/${endpoint}`);
                const endTime = Date.now();
                const responseTime = endTime - startTime;
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                
                testDiv.className = 'test success';
                testDiv.innerHTML = `
                    <h3>‚úÖ ${name} - SUCCESS (${responseTime}ms)</h3>
                    <p>Records: ${data.length || 0}</p>
                    <details>
                        <summary>View Sample Data</summary>
                        <pre>${JSON.stringify(data.slice(0, 2), null, 2)}</pre>
                    </details>
                `;
                
                return { success: true, data: data };
                
            } catch (error) {
                testDiv.className = 'test error';
                testDiv.innerHTML = `
                    <h3>‚ùå ${name} - FAILED</h3>
                    <p>Error: ${error.message}</p>
                `;
                return { success: false, error: error.message };
            }
        }
        
        async function runTests() {
            document.getElementById('tests').innerHTML = '';
            
            const tests = [
                { endpoint: 'get_reviews.php', name: 'Reviews API' },
                { endpoint: 'get_brands.php', name: 'Brands API' },
                { endpoint: 'get_models.php', name: 'Models API' },
                { endpoint: 'get_events.php', name: 'Events API' }
            ];
            
            let passed = 0;
            let failed = 0;
            
            for (const test of tests) {
                const result = await testAPI(test.endpoint, test.name);
                if (result.success) passed++;
                else failed++;
            }
            
            document.getElementById('status').innerHTML = `
                <h2>Test Results: ${passed} Passed, ${failed} Failed</h2>
                <p>Database Connection: ${passed > 0 ? '‚úÖ ACTIVE' : '‚ùå OFFLINE'}</p>
            `;
        }
        
        // Run tests on page load
        runTests();
    </script>
</body>
</html>